sources:
  dataplex-source:
    kind: "dataplex"
    project: ${DATAPLEX_PROJECT}

tools:
  search_entries:
    kind: dataplex-search-entries
    source: dataplex-source
    description: |
      Find all entries in Dataplex Catalog (e.g. tables, views, models) that match the provided search query.

      The output will look like this:

      {
        "results": [
          {
            object (SearchEntriesResult)
          }
        ],
        "totalSize": integer,
        "nextPageToken": string,
        "unreachable": [
          string
        ]
      }

      WHERE you have to keep note of results, totalSize and nextPageToken AND
      
      WHERE

      SearchEntriesResult has the following format:
      {
        "dataplexEntry": {
          object (Entry)
        }
      }

      WHERE

      you have to refer to description of dataplex-lookup-entry for details about the fields in the Entry object.

      Show the search entries results in a **nested ordered list** format to the user. Remember all the fields but respond with only the following fields:
      - Name: display_name of the entry
      - Project: project_id of the entry
      - Location: location of the entry

      Format the output in nested ordered list in the following way:
      
      1. customer_data
            project: my_project1
            location: us
      2. user_data
            project: test_project7
            location: us-central1

      These are invalid format of outputs for the user:
      Output:
      1. test345 (has extra fields)
            project: test_project2
            location: us
            type: table
      2. test123 (not nested)
      project: test_project3
      location: us-central1
      3. test (not nested)  project: test_project4 location: us-central1

      If there are multiple entries found, you should present the list of entries to the user and ask them to choose one.
      If there is only one entry found, you can ask the user if they want to see the details of that entry or if they want to search for another entry.
      If the response from the tool is empty then it means that there were no matching entries found. Notify the user about this and ask them to provide a more specific query.
  lookup_entry:
    kind: dataplex-lookup-entry
    source: dataplex-source
    description: |
      Get details about a specific entry in Catalog.

      The output contains an instance of the Entry and will look like this:

      {
        "name": string,
        "entryType": string,
        "createTime": string,
        "updateTime": string,
        "aspects": {
          string: {
            object (Aspect)
          },
          ...
        },
        "parentEntry": string,
        "fullyQualifiedName": string,
        "entrySource": {
          object (EntrySource)
        }
      }

      Whenever this tool is called, you have to remember all the fields but return only the following fields:
      - resource_name - resource name of the entry
      - display_name - human readable name of the entry
      - description - description of the entry
      - type - type of the entry (e.g. table, view, model)
      - project_id - project where the entry is stored
      - location - location where the entry is stored

      This is valid example of an Entry object:
      ```
      {
        "resource_name": "projects/test-project/locations/us/entryGroups/@bigquery/entries/bigquery.googleapis.com/projects/test-project/datasets/test-dataset/tables/test-table1",
        "display_name": "test-table1",
        "description": "This is a test table",
        "type": "table",
        "project_id": "test-project",
        "location": "us"
      }
      ```
      You should present the details to the user in a human-readable format like this:
      ```
      Display Name: test-table1
      Description: This is a test table
      Resource Name: projects/test-project/locations/us/entryGroups/@bigquery/entries/bigquery.googleapis.com/projects/test-project/datasets/test-dataset/tables/test-table1
      Type: table
      Project ID: test-project
      Location: us
      ```
      ```
      Display Name: user-instance2
      Description: This is a test instance
      Resource Name: projects/test-project/locations/us/entryGroups/@bigtableadmin/entries/bigtableadmin.googleapis.com/projects/my-project-123/instances/my-instance-abc
      Type: instance
      Project ID: test-project
      Location: us-central1
      ```
      ```
      Display Name: test-table32
      Description: This is a test table from an external 3P data source.
      Resource Name: projects/test-project/locations/us-central1/entryGroups/external-3p-entry-group/entries/test-table1
      Type: table
      Project ID: test-project
      Location: us
      ```
      If the response from the tool is empty then it means that there were no matching entries found. Notify the user that the entry was not found.

      Users can have follow up questions on any field of the Entry object. Suggest the user to ask some possible questions.

toolsets:
  dataplex-tools:
    - search_entries
    - lookup_entry
